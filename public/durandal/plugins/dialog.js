// Generated by CoffeeScript 1.7.1
(function() {
  define(['knockout', 'jquery', 'plugins/dialog', 'plugins/router'], function(ko, $, dialog, router) {
    return dialog.addContext('OdoDialog', {
      compositionComplete: function(child, parent, context) {
        var $child, $host, options, theDialog;
        $child = $(child);
        options = {
          backdrop: 'static'
        };
        theDialog = dialog.getDialog(context.model);
        $host = $(theDialog.host);
        $host.modal(options);
        $('body').scrollTop(0);
        $host.one('shown.bs.modal', function() {
          return $child.find('[autofocus],.autofocus').first().focus();
        });
        if ($child.hasClass('autoclose')) {
          return $host.one('shown.bs.modal', function() {
            return $host.one('click.dismiss.modal', function() {
              return theDialog.close();
            });
          });
        }
      },
      addHost: function(theDialog) {
        var body, host;
        body = $('body');
        host = $('<div class="modal fade" id="odo-modal" tabindex="-1" role="dialog" aria-hidden="true">').appendTo(body);
        theDialog.host = host.get(0);
        if (router.disable != null) {
          return router.disable();
        }
      },
      removeHost: function(theDialog) {
        return $(theDialog.host).one('hidden.bs.modal', function() {
          ko.removeNode(theDialog.host);
          if (router.enable != null) {
            return router.enable();
          }
        }).modal('hide');
      }
    });
  });

}).call(this);
