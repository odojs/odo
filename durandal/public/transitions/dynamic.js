// Generated by CoffeeScript 1.7.1
(function() {
  define(['durandal/system', 'plugins/router', 'q', './animate.css'], function(system, router, Q, Animate) {
    var result;
    return result = function(context) {
      var defered, view;
      defered = Q.defer();
      if (router.currentTransition != null) {
        console.log('We have a transition ' + router.currentTransition);
        requirejs(['transitions/' + router.currentTransition], function(transition) {
          return transition(context).then(defered.resolve());
        });
      } else {
        console.log('No transition for this one');
        if (context.scrolltop == null) {
          context.scrolltop = true;
        }
        if (context.activeView != null) {
          $(context.activeView).hide();
        }
        if (context.child != null) {
          context.triggerAttach();
          view = $(context.child).show();
          if ((context.scrolltop != null) && $(window).scrollTop() > view.offset().top) {
            $('html, body').css({
              scrollTop: view.offset().top
            });
          }
          view.find('[autofocus],.autofocus').first().focus();
        }
        defered.resolve();
      }
      return defered.promise;
    };
  });

}).call(this);
