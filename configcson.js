// Generated by CoffeeScript 1.7.1
(function() {
  define(['module', 'fs', 'path', 'cson'], function(module, fs, path, CSON) {
    var config, copy, domainodoconfig, envdomain, odoconfig, parse, result;
    config = {
      express: {
        'session key': true,
        'cookie secret': true,
        'session secret': true,
        'allowed cross domains': true
      },
      passport: {
        twitter: {
          'consumer key': true,
          'consumer secret': true,
          host: true
        },
        facebook: {
          'app id': true,
          'app secret': true,
          host: true
        },
        google: {
          realm: true,
          host: true
        },
        metocean: {
          'client id': true,
          'client secret': true,
          host: true,
          'authorization url': true,
          'token url': true
        }
      },
      mandrill: {
        'api key': true
      },
      odo: {
        auth: {
          signout: true
        }
      }
    };
    copy = function(source, target) {
      var key, value, _results;
      _results = [];
      for (key in source) {
        value = source[key];
        if (typeof value === 'object') {
          if (target[key] == null) {
            target[key] = {};
          }
          _results.push(copy(value, target[key]));
        } else {
          _results.push(target[key] = value);
        }
      }
      return _results;
    };
    parse = function(prefix, node, result) {
      var envkey, key, value, _results;
      _results = [];
      for (key in node) {
        value = node[key];
        envkey = "" + prefix + (key.toUpperCase().replace(/[ -]/g, '_'));
        if (typeof value === 'object') {
          if (result[key] == null) {
            result[key] = {};
          }
          _results.push(parse("" + envkey + "_", value, result[key]));
        } else if (value === true && (process.env[envkey] != null)) {
          _results.push(result[key] = process.env[envkey]);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    };
    result = CSON.parseFileSync(path.join(path.dirname(module.uri), '../../config.cson'));
    if (process.env.ODO_CONFIG != null) {
      odoconfig = CSON.parseSync(process.env.ODO_CONFIG);
      copy(odoconfig, result);
    }
    envdomain = result.odo.domain.toUpperCase().replace(/[ -]/g, '_');
    if (process.env["" + envdomain + "_ODO_CONFIG"] != null) {
      domainodoconfig = CSON.parseSync(process.env["" + envdomain + "_ODO_CONFIG"]);
      copy(domainodoconfig, result);
    }
    parse('', config, result);
    parse("" + envdomain + "_", config, result);
    return result;
  });

}).call(this);
